# ðŸš€ Kestra Configuration for Render Deployment
kestra:
  # Server configuration
  server:
    port: ${KESTRA_SERVER_PORT:10000}
    host: "0.0.0.0"
    access-log:
      enabled: true
      format: "combined"
    
  # Repository configuration (persistent for production)
  repository:
    type: postgres
    
  # Queue configuration (persistent for production)
  queue:
    type: postgres
    
  # Storage configuration (persistent local filesystem)
  storage:
    type: local
    local:
      base-path: /app/storage
      
  # Database configuration (persistent H2 file for Render)
  datasources:
    postgres:
      url: jdbc:h2:file:/app/storage/kestra;DB_CLOSE_DELAY=-1;AUTO_SERVER=TRUE
      driverClassName: org.h2.Driver
      username: kestra
      password: "${KESTRA_DATASOURCES_POSTGRES_PASSWORD}"
      
  # Security configuration (basic auth for production)
  security:
    type: basic
    basic:
      enabled: true
      username: "${KESTRA_SECURITY_BASIC_USERNAME}"
      password: "${KESTRA_SECURITY_BASIC_PASSWORD}"
      
  # Plugins configuration
  plugins:
    repositories:
      central:
        url: https://repo1.maven.org/maven2/
      kestra:
        url: https://dl.bintray.com/kestra-io/maven
        
  # Logging configuration
  logging:
    level:
      io.kestra: INFO
      root: WARN
      
  # Metrics configuration
  metrics:
    enabled: true
    
  # Variables (can be overridden by Render environment variables)
  variables:
    perplexity_api_key: "${PERPLEXITY_API_KEY}"
    supabase_url: "${SUPABASE_URL}"
    supabase_key: "${SUPABASE_KEY}"